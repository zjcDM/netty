17年校招进入华为一直工作至今，期间第一个项目是做数据库迁移服务，其中比较有挑战的工作是独立负责mongodb引擎的迁移。从方案调研以及落地上线全部由我自己完成，期间从使用开源工具到借助tungsten框架实现自研开发，最终实现了在ycsb模型下全量迁移70%场景性能超越友商，增量性能持平。在此基础上，构建自己的差异化竞争力，支持迁移账号权限，验证器，固定集合以及分片集群的迁移。

全量性能保证：
1、对集合进行分片，提高迁移的并行度。这边分片的方案先按类型分片，如果类型是objectid和数值类型，则继续分片。如果是数值类型，那么可以获取最大和最小的值，按一定大小的间隔进行分片。如果是objecid，因为objectid是由4部分组成的，最前面的是时间戳，所以可以获取到最大和最小的objectid，然后按照时间间隔进行分片。
2、全量期间的迁移，数据不落盘，全部走内存。
3、索引的创建时机，因为mongo的索引可以前台创建和后台创建，前台创建速度快，但是有限制，每一个db只有500m内存供创建索引，而且是阻塞式创建，所以一个在迁移的db中有多个collection，就会互相影响。而后台创建索引，是cpu时间空闲的时候才会创建，而在迁移期间，cpu是不空闲的，所以后台创建索引耗费的时间非常长。因此我们的方案折中，在迁移数据之前迁移索引，耗费的时间刚好在这两种方式之间。
4、批量插入，并且是否有序的参数设置为false
增量性能保证：
1、冲突高的、流量低的单线程回放。流量高的冲突低的并行回放。因为冲突高的流量低的做一系列冲突检测是多余的，单线程批量回放即可。而流量高的冲突低的，通过冲突检测进行并行回放，可以明显增加回放速度。

针对分片集群：
1、全量分片规则修改，全部按chunk进行分片。查询请求不包含shard key，则必须将查询分发到所有的shard，然后合并查询结果返回给客户端；查询请求包含shard key，则直接根据shard key计算出需要查询的chunk，向对应的shard发送查询请求
2、如果是hash分片，则提前预置chunks，减少chunk分裂。
3、分片的回放按照目标库chunk范围提前分组，避免在server写入时收到最小时延的shard的影响

第二个项目是开发华为搜索数据平台（就是去年随P40发布的petal search，花瓣搜索），这个项目是我带几个外包和一个新员工一起做的，在这个项目中，我的主要工作是数据从接入到下游的流程架构设计，异构数据统一方案设计，核心代码开发，与内容提供商需求交流接洽，以及整个项目的转测发布规划跟踪。最终成功接入20多个内容提供商的数据，性能上满足各个内容提供商的更新需求，及时支持搜索上线。


最近在做也是支撑华为搜索的在线检索引擎的优化，前期主要做特性开发，主要涉及elasticsearch分片的分配特性需求开发，近几个月主要是做性能优化，一个是scriptscorefunction打分优化，通过自定义docvalues数据结构，每个scriptscorefunction共享缓存，单次检索时延平均降低18ms。另一个优化工作是，对scoreFunction的得分进行缓存，业务场景中的不变的scorefunction和高频scorefunction的得分提前缓存，单次检索时延平均降低15ms。


1、插入冲突：直接覆盖（先删除，再插入）
2、更新不命中：忽略
3、删除不命中：忽略



1、自己的优点
2、自己的缺点
3、为什么跳槽
4、你经历最失败的项目是什么？如果重新做一次，怎样做的更好
5、你经历的最大挫折是什么？  
6、996的工作节奏可以接受吗？ 
	你对我们公司有什么了解？

   如果你在这次面试中没有被录用，你会怎么办?

   如果你被我们录取了，接下来你将如何开展工作？

   你怎么理解你应聘的职位？

   你的好朋友是如何评价你的？

   你与上司意见不一致时，该怎么办？

   你能说说你的家庭吗？

   你认为自己最适合做什么？

   你如何看待公司的加班现象？

   你的业余爱好是什么？

   你和别人发生过争执吗？你怎样解决？

   你如何面对压力？ 
   最近一次升级的原因
   来阿里能给我们带来什么
   技术点，困难点
   
   
跨团队交流：
   了解对方及其团队
俗话说：知己知彼，百战不殆。在沟通之前了解沟通对象和其团队是比较重要的前提，不管对方找你合作还是你找对方合作。搞清楚对方的角色是什么、对方负责什么。一般的，团队里面有很多角色，例如：有领导、有一线员工，有搞销售的，也有做研究的，还可能有市场推广的。角色的不同，关注点也是不一样的，如果一味的强调对方不关注或者不了解的东西，必然导致沟通效率低下。不同工种可能会喜欢不同的沟通方式，例如：程序员比较喜欢开门见山、直截了当的风格，领导则可能需要先寒暄夸赞几句等气氛热起来再说事情，当然这个也要因人而异。如果对方找你合作，你还要明确此次沟通的目的是什么，因为是信息不对称的，所以更应该寻找更多的信息做出明智的判断。

准备时多考虑对方利益
和团队内部沟通不一样，跨团队沟通的时候更要注意换位思考。如果是找对方合作，在准备的时候就要考虑到对方，例如：做这些事情对方需要付出什么，会给对方带来什么收益，对方又要损失些什么。不能因为考虑到对方不乐意做而一开始就选择让步，也不能完全忽视对方的利益只考虑自己团队的利益。如果一件事情收益很大、值得强力去推，准备的时候更多的考虑给对方带来什么，可以稍微回避对方的付出和损失，重点强调对方的收益，让对方觉得这件事同样意义重大。

注意表达和倾听
其实不管什么沟通，都应注意这个问题。简单来说，在表达上要有目的性，有条理，内容具体，不绕弯子。因为是不同团队，这里要注意用对方能听得懂的语言，同时，在表达完毕后，如有必要还应确认对方是不是理解到位，相应的，如果对方找你合作，你一定要听懂对方表达的东西，注意确认细节。在听对方表达的时候，表现出尊重，把对方表达出来的东西考虑进方案，做到综合考虑。沟通过程中时刻明确自己的目的，尤其是在寻求合作的时候，不要被对方先入为主乱了阵脚。

有耐心，会变通
1
沟通中出现分歧、达不成一致是很正常的，不要惧怕分歧和冲突。如果很难达成一致，那么沟通过程可能会比较长，首先一定要有耐心，因为控制不好情绪很可能导致合作失败，甚至留下不好的印象影响后面的合作。理性的分析自己或者对方要推进的事情，知道事情的目的，学会变通，思考一下这个事情对方哪里不接受，能不能换一个方式。遇到态度强硬的人，可以尝试获取第三方的支持，让客观的人、更权威的人来分析这个问题，还有，让数据和事实说话，避免给人一种蛮横不讲道理的样子。如果事情合理但又实在推不动的话，可以找领导（自己领导和对方领导），切记对事不对人。最后，既然是跨部门，那说明还是同一公司或者同一个利益体，在各种沟通无果的情况下，换方案考虑如何让公司利益最大化。


真诚
1
个人觉得，技巧和方法不见得管用，有时候【真诚】比什么都好使。沟通过程中，不要只考虑自己的目的和收益，也要考虑对方团队，多进行换位思考，这样事情可能推进的更快。还有，在达成共识后，一定要落地行动，兑现承诺。
